FROM registry.access.redhat.com/ubi9/python-311

RUN microdnf install -y \
    git \
    ca-certificates \
  && microdnf clean all

WORKDIR /app

COPY src/ ./src/
COPY requirements.txt ./

RUN pip install --no-cache-dir -r requirements.txt

COPY cache_model.py .

ENV PYTHONUNBUFFERED=1 \
    MODEL_CACHE_DIR=/tmp/model_cache

CMD ["python", "cache_model.py"]
